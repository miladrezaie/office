<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="admin/_layout">
<head>
    <meta charset="UTF-8">
    <title>اتوماسیون آفیش</title>
</head>
<body>
<div class="row" layout:fragment="main_content">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <div th:if="${message}" th:text="${message}" th:class="${'alerting alert ' + alertClass}"/>

                <th:block sec:authorize="hasAuthority('OP_AFZODAN_OFFICE')">
                    <button type="button" class="btn btn-info fnBtn float-right" id="newoffice"><i class="fa fa-plus"></i>جدید</button>
                </th:block>
                <div class="card-tools">
                    <div class="input-group input-group-sm" style="width: 150px;">
<!--                        <input type="text" name="table_search" class="form-control float-right" placeholder="جستجو">-->
<!--                        <div class="input-group-append">-->
<!--                            <button type="submit" class="btn btn-default"><i class="fa fa-search"></i></button>-->
<!--                        </div>-->
                    </div>
                </div>
            </div>
            <!-- /.card-header -->
            <div class="card-body table-responsive p-0">
                <table class="table table-hover ">
                    <tbody>
                    <tr>
                        <th>شماره</th>
                        <th>نام برنامه</th>
                        <th>نام تهیه کننده</th>
                        <th>محل آفیش</th>
                        <th>نوع آفیش</th>
                        <th>تکمیل آفیش</th>
                        <th>تاریخ ثبت</th>
                        <th>تنظیمات</th>
                    </tr>
                    <tr th:each="form , state : ${officeforms}">
                        <td class="persianumber" th:utext="${state.count}"></td>
                        <td th:utext="${form.program.getName()}"> </td>
                        <td th:utext="${form.getUsers().get(0).getFullname()}"></td>
                        <td th:utext="${form.location.getName()}"></td>
                        <td th:utext="${form.getType().getDisplayName()}"></td>
                        <td th:if="${form.getStatus() ==false}"><span class="badge badge-warning">در روند تکمیل</span></td>
                        <td th:if="${form.getUserCancelOfficeDescriptions().isEmpty()==false}">
                            <a th:attr="data-target='#modal-warning'+${state.count }"
                               href="#myModal" data-toggle="modal" class="MainNavText" id="laghvDescOffice">
                                <span class="badge bg-danger">لغو شده</span>
                            </a>

                        </td>
                        <td th:if="${form.getStatus() ==true && form.getUserCancelOfficeDescriptions().isEmpty()==true}">
                            <a th:attr="data-target='#modal-warningg'+${state.count }"
                               href="#myModal" data-toggle="modal" class="MainNavText" id="takmilDescOffice">
                                <span class="badge badge-success" >تکمیل شده</span>
                            </a>
                        </td>
                        <td class="persianumber" th:utext="${form.getTarikhsodur()}"></td>

                        <td>
                            <a th:href="@{form/(id=${form.id})}" class="mdelBtn" id="DeleteUser"><span class="badge bg-info">نمایش</span></a>
                            <th:block sec:authorize="hasAuthority('OP_MODEIR_VAHED_DARKHST_KONANDEH')">
                                <a th:attr="data-target='#modal-warning'+${form.getId() }" href="#myModal" data-toggle="modal" class="MainNavText" id="MainNavHelp">
                                    <span class="badge bg-danger">حذف</span>
                                </a>
                            </th:block>
                        </td>
                        <div class="modal fade" th:id="modal-warning+${form.getId()}" tabindex="-1" role="dialog"
                             aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel"
                                            th:utext="${form.getTahayekonande()}"></h5>
                                        <button style="display: contents;" type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <p class="alert alert-danger">
                                            آیا شما مطمین هستید که میخواهید این آفیش را پاک کنید ؟
                                        </p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">بستن</button>
                                        <a th:href="@{/admin/officeform/delete/{id}(id=${form.id})}"
                                           class="btn btn-danger">حذف</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal fade" th:id="modal-warning+${state.count}" tabindex="-1" role="dialog"
                             aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel"
                                            th:utext="${form.program.getName()}"></h5>
                                        <button style="display: contents;" type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body" th:each="ssss : ${form.getUserCancelOfficeDescriptions()}" >
                                        <p th:text="${ssss.getDescription()}"></p>
                                        <br>
                                        <br>
                                        <p th:text="${ssss.getUser().getFullname() + ' ( ' + ssss.getUser().getJob().getName()+' ) '}"> </p>

                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">بستن</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal fade" th:id="modal-warningg+${state.count}" tabindex="-1" role="dialog"
                             aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel"
                                            th:utext="${form.program.getName()}"></h5>
                                        <button style="display: contents;" type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body"  >
                                        <div class="row">
                                            <div class="col-12">
                                                <h4 class="text-center">
                                                    [[${form.getType().getDisplayName()}]]
                                                </h4>
                                                <br>
                                            </div>
                                            <!-- /.col -->
                                        </div>
                                        <!-- info row -->
                                        <div class="row invoice-info">
                                            <div class="col-sm-4 invoice-col">
                                                <address>
                                                    <small style="font-size: 15px;"><strong>نام برنامه &nbsp;:</strong>&nbsp;
                                                        [[${form.getProgram().getName()}]] &nbsp;</small>
                                                </address>
                                            </div>
                                            <!-- /.col -->
                                            <div class="col-sm-4 invoice-col">
                                                <address>

                                                </address>
                                            </div>
                                            <!-- /.col -->
                                            <div class="col-sm-4 invoice-col">
                                                <address>
                                                    <small style="font-size: 15px;"><strong>تاریخ شروع :</strong>&nbsp; [[${form.getDate_begin()}]]
                                                        &nbsp;</small><br>
                                                    <small style="font-size: 15px;"><strong>تاریخ اتمام :</strong>&nbsp; [[${form.getDate_end()}]]
                                                        &nbsp;</small>
                                                </address>
                                            </div>
                                            <!-- /.col -->
                                        </div>
                                        <div class="row invoice-info">
                                            <div class="col-sm-4 invoice-col">
                                                <address>
                                                    <strong>مکان آفیش :</strong><br>
                                                    [[${form.location.getName()}]]<br>
                                                </address>
                                            </div>
                                            <!-- /.col -->
                                            <div class="col-sm-4 invoice-col">
                                                <address>

                                                </address>
                                            </div>
                                            <!-- /.col -->
                                            <div class="col-sm-4 invoice-col ">
                                                <address>
                                                    <strong>ساعت آفیش :</strong><br>
                                                    [[${form.saat_zabt}]] - [[${form.saat_zabt_end}]]<br>
                                                </address>
                                            </div>
                                            <!-- /.col -->
                                        </div>

                                        <br>
                                        <br>
                                        <p >آفیش مورد نظر با موفقیت تکمیل شد . </p>



                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-success" data-dismiss="modal">بستن</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </tr>
                    </tbody>
                </table>
            </div>
            <!-- /.card-body -->

            <div class="card-footer clearfix" >
                <div class="pagination-div">
                    <span th:if="${page.hasPrevious()}">
                        <a th:href="@{/officeTrue(page=${page.number-1},size=${page.size})}" th:if="${page.size>=1}">قبلی</a>
                    </span>
                                    <th:block th:each="i: ${#numbers.sequence(0, page.totalPages - 1)}">
                                        <span th:if="${page.number == i}" class="selected">[[${i}+1]]</span>
                                        <span th:unless="${page.number == i}">
                             <a th:href="@{/officeTrue(page=${i},size=${page.size})}">[[${i}+1]]</a>
                        </span>
                                    </th:block>
                                    <span th:if="${page.hasNext()}">
                        <a th:href="@{/officeTrue(page=${page.number+1},size=${page.size})}">بعدی</a>
                    </span>
                </div>

            </div>
        </div>
        <!-- /.card -->
    </div>
    <div class="fmyForm " id="of_modal">
        <form th:action="@{/saveForm}" name="off_form_form" id="off_form_form" method="post"
              enctype="multipart/form-data">
            <div class="modal fade" id="fexampleModal" tabindex="-1" role="dialog"
                 aria-labelledby="exampleModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">آفیش</h5>
                            <button style="display: contents;" type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>

                        <div class="modal-body">
                            <div class="form-group">
                                <label for="tahayekonande" class="form-control-label">نام تهیه کننده:</label>
                                <input type="text" class="form-control" id="tahayekonande" name="tahayekonande"
                                       th:value="${user.getFullname()}" readonly="readonly"/>
                            </div>

                            <div class="form-group">
                                <label for="program" class="form-control-label">نام برنامه:</label>
                                <select class="form-control" id="program" name="program">
                                    <option value="">نوع آفیش را انتخاب کنید</option>
                                    <option th:each="pro :${programs}" th:value="${pro.getId()}"
                                            th:text="${pro.getName()}"></option>
                                </select>
                            </div>

                            <div class="form-inline form-group">
                                <div class="input-group input-group-sm">
                                    <label for="date_begin" class="form-control-label">از تاریخ :</label>
                                    <input type="text" id="date_begin" name="date_begin"
                                           class="pwt-datepicker-input-element office-date">
                                    <label for="date_end" class="form-control-label">تا تاریخ : </label>
                                    <input type="text" id="date_end" name="date_end"
                                           class="pwt-datepicker-input-element office-date">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="saat_zabt" class="form-control-label">ساعت شروع ضبط:</label>
                                <input type="text" id="saat_zabt" name="saat_zabt" class="office-date-time" value=""/> مانند : 12:10
                                <br>
                                <label for="saat_zabt_end" class="form-control-label">ساعت پایان ضبط:</label>
                                <input type="text" id="saat_zabt_end" name="saat_zabt_end" class="office-date-time" value=""/> مانند : 13:10
                            </div>

                            <div class="form-group">
                                <label for="location" class="form-control-label">محل آفیش:</label>
                                <select class="form-control" id="location" name="location">
                                    <option value="">مکان را انتخاب کنید</option>

                                    <option th:each="location :${locations}" th:value="${location.getId()}"
                                            th:text="${location.getName()}"></option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="type" class="form-control-label">نوع آفیش:</label>
                                <select class="form-control" id="type" name="type">
                                    <option value="">نوع آفیش را انتخاب کنید</option>
                                    <option th:each="type :${officeTypes}" th:value="${type.name()}"
                                            th:text="${type.getDisplayName()}"></option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="description" class="form-control-label">توضیحات :(اختیاری)</label>
                                <textarea name="description" id="description" cols="85" rows="10"></textarea>
                            </div>

                        </div>
                        <div class="modal-footer border-top-0 d-flex justify-content-center">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">بستن</button>
                            <input type="submit" class="btn btn-success" id="saveeditbutton" value=""/>
                        </div>
                    </div>

                </div>


            </div>
        </form>
    </div>

</div>

</body>
</html>